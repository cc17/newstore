define("src/js/cat/cat",["src/js/libs/jquery","src/js/libs/subbyte","src/js/libs/template","src/js/libs/Dialog","src/js/libs/AppDialogTpl","src/js/libs/Observer","src/js/libs/searchForm","src/js/libs/reportValue","src/js/libs/xss","src/js/libs/queryString","src/js/libs/FixAppstatus","src/js/libs/needUpdate","src/js/libs/mainNavItem","src/js/libs/returnToTop","src/js/libs/throttle","src/js/libs/debounce","src/js/libs/urls_config","./getCats"],function(a){function b(a){this.cacheFlag={},this.cache={},this.$tabBdWrap=d(a.bd),this.$tabHdWrap=d(a.hd),this.tpl=d(a.tpl).html(),this.inited=!1,n.get().then(d.proxy(this.getData,this))}function c(a){new b(a)}var d=a("src/js/libs/jquery"),e=(a("src/js/libs/subbyte"),a("src/js/libs/template")),f=a("src/js/libs/Dialog"),g=a("src/js/libs/AppDialogTpl"),h=a("src/js/libs/Observer"),i=(a("src/js/libs/searchForm"),a("src/js/libs/FixAppstatus"));a("src/js/libs/returnToTop").init();var j=a("src/js/libs/urls_config"),k=(new Date).getTime(),l=j.offlineStatus?j.offline.cat+"?t="+k:j.online.cat,m={},n=a("./getCats");return b.prototype={constructor:b,getData:function(a){a&&(this.tabId=a);var b,c=this;(b=this.cacheFlag[this.tabId])?this.renderUi(b):d.ajax({url:j.offlineStatus?l:l+a+"&t="+k,beforeSend:function(){c.$tabBdWrap.find(".cat-bd-"+a).html('<div class="loading"></div>')}}).done(d.proxy(c.fixData,c))},fixData:function(a){if(a="string"==typeof a?JSON.parse(a):a,!a.res)return this.$tabBdWrap.find(".cat-bd-"+this.tabId).html("暂无数据"),void 0;var b=a.info;b=i.fixAppData(b),this.cacheData(b),this.renderUi(b)},cacheData:function(a){this.cacheFlag[this.tabId]=a;var b=this;a.length&&d.each(a,function(a,c){b.cache[c.app_uuid]=c})},getCacheByuuid:function(a){return m[a]},renderUi:function(a){var b=this;if(a.length){var c=e(b.tpl,{data:a});this.$tabBdWrap.find(".cat-bd-"+this.tabId).html(c),this.inited||(this.inited=!0,this.bindEvt())}},bindEvt:function(){var a=this.$tabBdWrap,b=a.find(".cat-bd-"+this.tabId),c=this.$tabHdWrap.find('h3[data-type="'+this.tabId+'"]'),e=this.dataType,i=this;this.$tabHdWrap.on("click","h3",function(){var f=d(this),g=f.attr("data-type");if(e!=g){i.tabId=g,i.getData(g),c.removeClass("current"),f.addClass("current"),c=f,b.hide();var h=a.find(".cat-bd-"+g);h.show(),b=h,e=g}}),this.$tabBdWrap.on("click","a",function(){var a,b=d(this),c=b.attr("data-uuid");if(c&&(a=i.cache[c])){var e=g.render({data:a}),h=new f("x",{zIndex:20,title:"",w:952,h:580,noFixPos:!0,content:e,fixClass:"add-dialog",contentClass:"add-dialog-outer"});h.show()}}),h.register("updateData",this.updateData,this)},updateData:function(a){this.cache[a]&&(this.cache[a].installed=!0)}},{start:c}}),define("src/js/cat/getCats",["src/js/libs/jquery","src/js/libs/urls_config"],function(a){var b,c=a("src/js/libs/jquery"),d=a("src/js/libs/urls_config"),e=(new Date).getTime(),f=d.offlineStatus?d.offline.getCats+"?t="+e:d.online.getCats+"&t="+e,g=location.search&&location.search.match(/\?cat=(\d+)/);return g&&g.length&&(b=g[1]),{get:function(){var a=c.Deferred(),d=this;return c.ajax({url:f}).done(function(a){a="string"==typeof a?JSON.parse(a):a,a.res&&d.build(a.info)}).then(function(){a.resolve(b)}),a.promise()},build:function(a){var d=[],e=[];c.each(a,function(a,c){b||(b=a);var f=b==a;d.push('<h3 class="fl '+(f?"current":"")+'" data-type="'+a+'">'+c+"</h3>"),e.push('<div class="J-bd-item cat-bd-'+a+' cl" style="display: '+(f?"":"none;")+'"></div>')}),c(".J-cat-hd").html(d.join("")),c(".J-cat-bd").html(e.join(""))}}});